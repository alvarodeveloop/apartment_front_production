{"version":3,"sources":["pages/masters/PersonalEnterpriseFormPage.jsx"],"names":["PersonalEnterpriseFormPage","props","useState","validated","setValidated","enterprises","setEnterprises","charges","setCharges","name","rut","last_names","address","id_enterprise","id_charge","email","phone_1","phone_2","data","setData","inputRef","useRef","useEffect","fetchData","current","focus","promises","axios","get","API_URL","match","params","id","push","Promise","all","then","result","catch","err","response","toast","error","message","onChange","e","target","val","value","split","join","substring","length","gotBackToTable","history","replace","clearForm","className","sm","md","lg","xs","onSubmit","form","currentTarget","preventDefault","checkValidity","stopPropagation","objectPost","Object","assign","put","success","post","noValidate","inputRut","handleChange","ref","inputName","inputLastNames","inputAddress","inputEmail","inputPhone","inputPhone2","inputEnterprise","map","v","i","key","inputCharge","type","size","variant","block","onClick","defaultProps","required","label","messageErrors","cols"],"mappings":"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","file":"static/js/75.f3059e45.chunk.js","sourcesContent":["import React, { useState , useEffect, useRef } from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport {\r\n  Container,\r\n  Row,\r\n  Col,\r\n  Button,\r\n  Form\r\n} from 'react-bootstrap'\r\nimport InputField from 'components/input/InputComponent'\r\nimport InputFieldRef from 'components/input/InputComponentRef'\r\nimport axios from 'axios'\r\nimport { API_URL } from 'utils/constants'\r\nimport { toast } from 'react-toastify';\r\n\r\nconst PersonalEnterpriseFormPage = (props) => {\r\n\r\n  const [validated, setValidated] = useState(false)\r\n  const [enterprises, setEnterprises] = useState([])\r\n  const [charges, setCharges] = useState([])\r\n  const [data, setData] = useState({\r\n    name:'',\r\n    rut: '',\r\n    last_names: '',\r\n    address: '',\r\n    id_enterprise: '',\r\n    id_charge: '',\r\n    email: '',\r\n    phone_1: '',\r\n    phone_2: '',\r\n  })\r\n\r\n  const inputRef = useRef(null)\r\n  useEffect(() => {\r\n    fetchData()\r\n    inputRef.current.focus()\r\n  },[])\r\n\r\n  const fetchData = () => {\r\n    let promises = [\r\n      axios.get(API_URL+'enterprise'),\r\n      axios.get(API_URL+'master_charges'),\r\n    ]\r\n\r\n    if(props.match.params.id){\r\n      promises.push(\r\n        axios.get(API_URL+'personal_enterprise/'+props.match.params.id)\r\n      )\r\n    }\r\n\r\n    Promise.all(promises).then(result => {\r\n\r\n      setEnterprises(result[0].data)\r\n      setCharges(result[1].data)\r\n\r\n      if(result[2]){\r\n\r\n        setData({\r\n          name: result[2].data.name,\r\n          rut: result[2].data.rut,\r\n          email: result[2].data.email,\r\n          last_names: result[2].data.last_names,\r\n          phone_1: result[2].data.phone_1,\r\n          phone_2: result[2].data.phone_2,\r\n          address: result[2].data.address,\r\n          id_charge: result[2].data.id_charge,\r\n          id_enterprise: result[2].data.id_enterprise,\r\n          id: result[2].data.id\r\n        })\r\n\r\n      }\r\n\r\n    }).catch(err => {\r\n      if(err.response){\r\n        toast.error(err.response.data.message)\r\n      }else{\r\n        toast.error('Error, contacte con soporte')\r\n      }\r\n    })\r\n\r\n  }\r\n\r\n  const onChange = e => {\r\n    if(e.target.name === 'rut'){\r\n      let val = e.target.value\r\n      val = val ? val.split('-').join('') : val\r\n      val = val ? val.substring(0,val.length -1) +'-'+val.substring(val.length -1) : val\r\n      setData({...data, [e.target.name]: val})\r\n    }else{\r\n      setData({...data, [e.target.name]: e.target.value})\r\n    }\r\n  }\r\n\r\n  const handleSubmit = e => {\r\n\r\n    const form = e.currentTarget;\r\n\r\n    e.preventDefault();\r\n    if (form.checkValidity() === false) {\r\n      e.stopPropagation();\r\n      setValidated(true);\r\n      return\r\n    }\r\n\r\n    let objectPost = Object.assign({},data)\r\n\r\n    if(objectPost.id){\r\n      axios.put(API_URL+'personal_enterprise/'+objectPost.id,objectPost).then(result => {\r\n        toast.success('Registro Modificado')\r\n        gotBackToTable()\r\n      }).catch(err => {\r\n        if(err.response){\r\n          toast.error(err.response.data.message)\r\n        }else{\r\n          toast.error('Error, contacte con soporte')\r\n        }\r\n      })\r\n    }else{\r\n      axios.post(API_URL+'personal_enterprise',objectPost).then(result => {\r\n        toast.success('Registro Creado')\r\n        clearForm()\r\n      }).catch(err => {\r\n        if(err.response){\r\n          toast.error(err.response.data.message)\r\n        }else{\r\n          toast.error('Error, contacte con soporte')\r\n        }\r\n      })\r\n    }\r\n\r\n  }\r\n\r\n  const gotBackToTable = () => {\r\n    props.history.replace('/masters/personal')\r\n  }\r\n\r\n  const clearForm = () => {\r\n    setData({\r\n      name:'',\r\n      rut: '',\r\n      email: '',\r\n      phone_1: '',\r\n      phone_2: '',\r\n      address: '',\r\n      id_charge: '',\r\n      id_enterprise: '',\r\n      last_names: ''\r\n    })\r\n    setValidated(false)\r\n    inputRef.current.focus()\r\n  }\r\n\r\n  return (\r\n    <Container>\r\n      <Row className=\"containerDiv\">\r\n        <Col sm={12} md={12} lg={12} xs={12} className=\"text-right\">\r\n          <span className=\"text-danger\">*Campos Obligatorios</span>\r\n          <br/><br/>\r\n        </Col>\r\n        <Col sm={12} md={12} lg={12}>\r\n          <Form onSubmit={handleSubmit} noValidate validated={validated}>\r\n            <Row>\r\n              <InputFieldRef\r\n                {...props.inputRut}\r\n                value={data.rut}\r\n                handleChange={onChange}\r\n                ref={inputRef}\r\n              />\r\n              <InputField\r\n                {...props.inputName}\r\n                value={data.name}\r\n                handleChange={onChange}\r\n              />\r\n              <InputField\r\n                {...props.inputLastNames}\r\n                value={data.last_names}\r\n                handleChange={onChange}\r\n              />\r\n            </Row>\r\n            <Row>\r\n              <InputField\r\n                {...props.inputAddress}\r\n                value={data.address}\r\n                handleChange={onChange}\r\n              />\r\n              <InputField\r\n                {...props.inputEmail}\r\n                value={data.email}\r\n                handleChange={onChange}\r\n              />\r\n              <InputField\r\n                {...props.inputPhone}\r\n                value={data.phone_1}\r\n                handleChange={onChange}\r\n              />\r\n            </Row>\r\n            <Row>\r\n              <InputField\r\n                {...props.inputPhone2}\r\n                value={data.phone_2}\r\n                handleChange={onChange}\r\n              />\r\n              <InputField\r\n                {...props.inputEnterprise}\r\n                value={data.id_enterprise}\r\n                handleChange={onChange}\r\n              >\r\n                <option value=''>--Seleccione--</option>\r\n                {enterprises.map((v,i) => (\r\n                  <option value={v.id} key={i}>{v.name}</option>\r\n                ))}\r\n              </InputField>\r\n              <InputField\r\n                {...props.inputCharge}\r\n                value={data.id_charge}\r\n                handleChange={onChange}\r\n              >\r\n                <option value=''>--Seleccione--</option>\r\n                {charges.map((v,i) => (\r\n                  <option value={v.id} key={i}>{v.name}</option>\r\n                ))}\r\n              </InputField>\r\n            </Row>\r\n            <Row className=\"justify-content-center\">\r\n              <Col sm={4} md={4} lg={4}>\r\n                <Button type=\"submit\" size=\"sm\" variant=\"primary\" block={true}>Guardar</Button>\r\n              </Col>\r\n              <Col sm={4} md={4} lg={4}>\r\n                <Button type=\"submit\" size=\"sm\" variant=\"danger\" block={true} onClick={gotBackToTable}>Volver</Button>\r\n              </Col>\r\n            </Row>\r\n          </Form>\r\n        </Col>\r\n      </Row>\r\n    </Container>\r\n  )\r\n}\r\n\r\nPersonalEnterpriseFormPage.defaultProps = {\r\n  inputRut: {\r\n    type: 'text',\r\n    required: true,\r\n    name: 'rut',\r\n    label : 'Rut',\r\n    messageErrors: [\r\n      'Requerido*'\r\n    ],\r\n    cols:\"col-sm-4 col-md-4 col-lg-4 col-xs-4\"\r\n  },\r\n  inputLastNames: {\r\n    type: 'text',\r\n    required: true,\r\n    name: 'last_names',\r\n    label : 'Apelidos',\r\n    messageErrors: [\r\n      'Requerido*'\r\n    ],\r\n    cols:\"col-sm-4 col-md-4 col-lg-4 col-xs-4\"\r\n  },\r\n  inputName: {\r\n    type: 'text',\r\n    required: true,\r\n    name: 'name',\r\n    label : 'Nombre',\r\n    messageErrors: [\r\n      'Requerido*'\r\n    ],\r\n    cols:\"col-sm-4 col-md-4 col-lg-4 col-xs-4\"\r\n  },\r\n  inputAddress: {\r\n    type: 'textarea',\r\n    required: true,\r\n    name: 'address',\r\n    label : 'Dirección',\r\n    messageErrors: [\r\n      'Requerido*'\r\n    ],\r\n    cols:\"col-sm-4 col-md-4 col-lg-4 col-xs-4\"\r\n  },\r\n  inputEmail: {\r\n    type: 'email',\r\n    required: false,\r\n    name: 'email',\r\n    label : 'Email',\r\n    messageErrors: [\r\n      'Requerido*,',' Formato tipo Email*'\r\n    ],\r\n    cols:\"col-sm-4 col-md-4 col-lg-4 col-xs-4\"\r\n  },\r\n  inputPhone: {\r\n    type: 'number',\r\n    required: false,\r\n    name: 'phone_1',\r\n    label : 'Teléfono Principal',\r\n    messageErrors: [\r\n      'Requerido*'\r\n    ],\r\n    cols:\"col-sm-4 col-md-4 col-lg-4 col-xs-4\"\r\n  },\r\n  inputPhone2: {\r\n    type: 'number',\r\n    required: false,\r\n    name: 'phone_2',\r\n    label : 'Telefono Secundario',\r\n    messageErrors: [\r\n      'Requerido*'\r\n    ],\r\n    cols:\"col-sm-4 col-md-4 col-lg-4 col-xs-4\"\r\n  },\r\n  inputCharge: {\r\n    type: 'select',\r\n    required: true,\r\n    name: 'id_charge',\r\n    label : 'Cargo',\r\n    messageErrors: [\r\n      'Requerido*'\r\n    ],\r\n    cols:\"col-sm-4 col-md-4 col-lg-4 col-xs-4\"\r\n  },\r\n  inputEnterprise: {\r\n    type: 'select',\r\n    required: true,\r\n    name: 'id_enterprise',\r\n    label : 'Empresa',\r\n    messageErrors: [\r\n      'Requerido*'\r\n    ],\r\n    cols:\"col-sm-4 col-md-4 col-lg-4 col-xs-4\"\r\n  },\r\n}\r\n\r\nexport default PersonalEnterpriseFormPage\r\n"],"sourceRoot":""}